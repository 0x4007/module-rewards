<!DOCTYPE html>
<html>
<head>
    <title>Comment Score Decay Functions</title>
    <style>
        canvas {
            border: 1px solid #ccc;
            margin: 20px;
        }
        .stats {
            font-family: monospace;
            margin: 20px;
            white-space: pre;
        }
    </style>
</head>
<body>
    <canvas id="chart" width="800" height="400"></canvas>
    <div class="stats" id="stats"></div>

    <script>
        const canvas = document.getElementById('chart');
        const ctx = canvas.getContext('2d');
        const stats = document.getElementById('stats');

        // Scoring functions
        const logScore = (wordCount, baseScore = 100) =>
            baseScore * (1 / Math.log2(wordCount + 2));

        const expScore = (wordCount, baseScore = 100) =>
            baseScore * Math.exp(-wordCount/100);

        // Generate data points
        const data = [];
        for (let wordCount = 1; wordCount <= 1000; wordCount += 5) {
            data.push({
                wordCount,
                logScore: logScore(wordCount),
                expScore: expScore(wordCount)
            });
        }

        // Calculate some example points for stats
        const samples = [50, 100, 200, 500, 1000];
        let statsText = 'Word Count | Log Score | Exp Score\n';
        statsText += '-'.repeat(40) + '\n';
        samples.forEach(count => {
            statsText += `${count.toString().padEnd(9)} | ${logScore(count).toFixed(2).padEnd(9)} | ${expScore(count).toFixed(2)}\n`;
        });
        stats.textContent = statsText;

        // Setup chart dimensions
        const chartWidth = canvas.width - 60; // Leave space for y-axis
        const chartHeight = canvas.height - 40; // Leave space for x-axis
        const xStart = 40;
        const yStart = canvas.height - 30;

        // Draw axes
        ctx.beginPath();
        ctx.strokeStyle = '#000';
        ctx.moveTo(xStart, 10);
        ctx.lineTo(xStart, yStart);
        ctx.lineTo(canvas.width - 10, yStart);
        ctx.stroke();

        // Draw grid lines and labels
        ctx.strokeStyle = '#eee';
        ctx.fillStyle = '#000';
        ctx.textAlign = 'right';
        ctx.textBaseline = 'middle';

        // Y-axis grid and labels
        for (let score = 0; score <= 100; score += 20) {
            const y = yStart - (score/100 * chartHeight);
            ctx.beginPath();
            ctx.moveTo(xStart, y);
            ctx.lineTo(canvas.width - 10, y);
            ctx.stroke();
            ctx.fillText(score.toString(), xStart - 5, y);
        }

        // X-axis grid and labels
        ctx.textAlign = 'center';
        ctx.textBaseline = 'top';
        for (let words = 0; words <= 1000; words += 200) {
            const x = xStart + (words/1000 * chartWidth);
            ctx.beginPath();
            ctx.moveTo(x, 10);
            ctx.lineTo(x, yStart);
            ctx.stroke();
            ctx.fillText(words.toString(), x, yStart + 5);
        }

        // Plot logarithmic function
        ctx.beginPath();
        ctx.strokeStyle = 'blue';
        data.forEach((point, i) => {
            const x = xStart + (point.wordCount/1000 * chartWidth);
            const y = yStart - (point.logScore/100 * chartHeight);
            if (i === 0) {
                ctx.moveTo(x, y);
            } else {
                ctx.lineTo(x, y);
            }
        });
        ctx.stroke();

        // Plot exponential function
        ctx.beginPath();
        ctx.strokeStyle = 'red';
        data.forEach((point, i) => {
            const x = xStart + (point.wordCount/1000 * chartWidth);
            const y = yStart - (point.expScore/100 * chartHeight);
            if (i === 0) {
                ctx.moveTo(x, y);
            } else {
                ctx.lineTo(x, y);
            }
        });
        ctx.stroke();

        // Add legend
        ctx.textAlign = 'left';
        ctx.textBaseline = 'middle';
        ctx.fillStyle = 'blue';
        ctx.fillText('Logarithmic Decay', 60, 25);
        ctx.fillStyle = 'red';
        ctx.fillText('Exponential Decay', 60, 45);
    </script>
</body>
</html>
